<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body{
            background-image: url("https://t3.ftcdn.net/jpg/02/42/97/66/360_F_242976601_sj6Y2jqCG8AURbOxMbIHIiZEIrFq1tvk.jpg");
            background-size: cover;
            background-repeat: no-repeat;
        }
        * {
            margin: auto;
        }
        .container{
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            height: 100vh;
            background-color: transparent;
        }
        /* board */
        table{
            background-color:#ffffff;
            border: 2px solid #000000;
        }
        td{
            background-color: #c87f00;
            width: 65px;
            height: 65px;
            text-align: center;
        }
        .noPieceHere{
            background-color: #825000;
        }
        /* pieces */
        span{
            display: inline-block;
        }
        p{
            display: inline-block;
        }
        .redPiece{
            background-color: #ff0000;
            border: 1px solid #ffffff;
            width: 20px;
            height: 20px;
            padding: 12px;
            border-radius: 50px;
        }
        .blackPiece{
            background-color: #000000;
            border: 1px solid #ffffff;
            width: 20px;
            height: 20px;
            padding: 12px;
            border-radius: 50px;
        }
        .king.redPiece{
            background-color: #8b0000;
            border: 1px solid #ffffff;
            width: 20px;
            height: 20px;
            padding: 12px;
            border-radius: 50px;
        }
        .king.blackPiece{
            background-color: #001d5c;
            border: 1px solid #ffffff;
            width: 20px;
            height: 20px;
            padding: 12px;
            border-radius: 50px;
        }
        /* tells players whos turn it is*/
        .turnAlert{
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .RedTurn{
            text-align: center;
            color: black;
            font-size: 25px;
        }
        .BlackTurn{
            text-align: center;
            font-size: 25px;
            color: lightgray;
            opacity: 0.2;
        }
        #divider{
            font-size: 40px;
            margin-left: 15px;
            margin-right: 15px;
        }
    </style>
    <title>Checkers</title>
</head>
<body>
    <div class="container">
        <table>
            <tr>
                <td class="noPieceHere"></td><td><p class="redPiece" id="0"></p></td>
                <td class="noPieceHere"></td><td><p class="redPiece" id="1"></p></td>
                <td class="noPieceHere"></td><td><p class="redPiece" id="2"></p></td>
                <td class="noPieceHere"></td><td><p class="redPiece" id="3"></p></td>
            </tr>
            <tr>
                <td><p class="redPiece" id="4"></p></td><td class="noPieceHere"></td>
                <td><p class="redPiece" id="5"></p></td><td class="noPieceHere"></td>
                <td><p class="redPiece" id="6"></p></td><td class="noPieceHere"></td>
                <td><p class="redPiece" id="7"></p></td><td class="noPieceHere"></td>
            </tr>
            <tr>
                <td class="noPieceHere"></td><td><p class="redPiece" id="8"></p></td>
                <td class="noPieceHere"></td><td><p class="redPiece" id="9"></p></td>
                <td class="noPieceHere"></td><td><p class="redPiece" id="10"></p></td>
                <td class="noPieceHere"></td><td><p class="redPiece" id="11"></p></td>
            </tr>
            <tr>
                <td></td><td class="noPieceHere"></td>
                <td></td><td class="noPieceHere"></td>
                <td></td><td class="noPieceHere"></td>
                <td></td><td class="noPieceHere"></td>
            </tr>
            <tr>
                <td class="noPieceHere"></td><td></td>
                <td class="noPieceHere"></td><td></td>
                <td class="noPieceHere"></td><td></td>
                <td class="noPieceHere"></td><td></td>
            </tr>
            <tr>
                <td><span class="blackPiece" id="12"></span></td><td class="noPieceHere"></td>
                <td><span class="blackPiece" id="13"></span></td><td class="noPieceHere"></td>
                <td><span class="blackPiece" id="14"></span></td><td class="noPieceHere"></td>
                <td><span class="blackPiece" id="15"></span></td><td class="noPieceHere"></td>
            </tr>
            <tr>
                <td class="noPieceHere"></td><td><span class="blackPiece" id="16"></span></td>
                <td class="noPieceHere"></td><td><span class="blackPiece" id="17"></span></td>
                <td class="noPieceHere"></td><td><span class="blackPiece" id="18"></span></td>
                <td class="noPieceHere"></td><td><span class="blackPiece" id="19"></span></td>
            </tr>
            <tr>
                <td><span class="blackPiece" id="20"></span></td><td class="noPieceHere"></td>
                <td><span class="blackPiece" id="21"></span></td><td class="noPieceHere">
                <td><span class="blackPiece" id="22"></span></td><td class="noPieceHere"></td>
                <td><span class="blackPiece" id="23"></span></td><td class="noPieceHere"></td>
            </tr>
        </table>
        <div class="turnAlert">
            <div class="RedTurn">Red's Turn</div>
                <p id="divider">|</p>
            <div class="BlackTurn">Black's Turn</div>
        </div>
    </div>
    <script>
        const board = [
        null, 0, null, 1, null, 2, null, 3,
        4, null, 5, null, 6, null, 7, null,
        null, 8, null, 9, null, 10, null, 11,
        null, null, null, null, null, null, null, null,
        null, null, null, null, null, null, null, null,
        12, null, 13, null, 14, null, 15, null,
        null, 16, null, 17, null, 18, null, 19,
        20, null, 21, null, 22, null, 23, null
    ]

    // parses pieceId's and returns the index of that piece's place on the board
    let findPiece = function (pieceId){
        let parsed = parseInt(pieceId);
        return board.indexOf(parsed);
    };

    // DOM referenes
    const cells = document.querySelectorAll("td");
    let redsPieces = document.querySelectorAll("p");
    let blacksPieces = document.querySelectorAll("span")
    const RedTurn = document.querySelectorAll(".RedTurn");
    const BlackTurn = document.querySelectorAll(".BlackTurn");
    const divider = document.querySelector("#divider")

    // player properties
    let turn = true;
    let redScore = 12;
    let blackScore = 12;
    let playerPieces;

    // selected piece properties
    let selectedPiece ={
        pieceId: -1,
        indexOfBoardPiece: -1,
        isKing: false,
        seventhSpace: false,
        ninthSpace: false,
        fourteenthSpace: false,
        eighteenthSpace: false,
        minusSeventhSpace: false,
        minusNinthSpace: false,
        minusFourteenthSpace: false,
        minusEighteenthSpace: false
    }

    // initialize event listeners on pieces
    function givePiecesEventListeners(){
        if (turn){
            for (let i = 0; i < redsPieces.length; i++){
                redsPieces[i].addEventListener("click", getPlayerPieces);
            }
        } else{
            for (let i = 0; i < blacksPieces.length; i++){
                blacksPieces[i].addEventListener("click", getPlayerPieces);
            }
        }
    }

    // holds the length of piece count
    function getPlayerPieces(){
        if (turn){
            playerPieces = redsPieces;
        } else{
            playerPieces = blacksPieces;
        }
        removeCellonclick();
        resetBorders();
    }

    // removes possible moves from old selected piece (* this is needed because the user might re-select a piece *)
    function removeCellonclick(){
        for (let i = 0; i < cells.length; i++){
            cells[i].removeAttribute("onclick");
        }
    }

    // resets borders to default
    function resetBorders(){
        for (let i = 0; i < playerPieces.length; i++){
            playerPieces[i].style.border = "1px solid white";
        }
        resetSelectedPieceProperties();
        getSelectedPiece();
    }

    // resets selected piece properties
    function resetSelectedPieceProperties(){
        selectedPiece.pieceId = -1;
        selectedPiece.pieceId = -1;
        selectedPiece.isKing = false;
        selectedPiece.seventhSpace = false;
        selectedPiece.ninthSpace = false;
        selectedPiece.fourteenthSpace = false;
        selectedPiece.eighteenthSpace = false;
        selectedPiece.minusSeventhSpace = false;
        selectedPiece.minusNinthSpace = false;
        selectedPiece.minusFourteenthSpace = false;
        selectedPiece.minusEighteenthSpace = false;
    }

    // gets ID and index of the board cell its on
    function getSelectedPiece(){
        selectedPiece.pieceId = parseInt(event.target.id);
        selectedPiece.indexOfBoardPiece = findPiece(selectedPiece.pieceId);
        isPieceKing();
    }

    // checks if king
    function isPieceKing(){
        if (document.getElementById(selectedPiece.pieceId).classList.contains("king")){
            selectedPiece.isKing = true;
        } else{
            selectedPiece.isKing = false;
        }
        getAvailableSpaces();
    }

    // gets the moves that the selected piece can move
    function getAvailableSpaces(){
        if (board[selectedPiece.indexOfBoardPiece + 7] === null && 
            cells[selectedPiece.indexOfBoardPiece + 7].classList.contains("noPieceHere") !== true){
            selectedPiece.seventhSpace = true;
        }
        if (board[selectedPiece.indexOfBoardPiece + 9] === null && 
            cells[selectedPiece.indexOfBoardPiece + 9].classList.contains("noPieceHere") !== true){
            selectedPiece.ninthSpace = true;
        }
        if (board[selectedPiece.indexOfBoardPiece - 7] === null && 
            cells[selectedPiece.indexOfBoardPiece - 7].classList.contains("noPieceHere") !== true){
            selectedPiece.minusSeventhSpace = true;
        }
        if (board[selectedPiece.indexOfBoardPiece - 9] === null && 
            cells[selectedPiece.indexOfBoardPiece - 9].classList.contains("noPieceHere") !== true){
            selectedPiece.minusNinthSpace = true;
        }
        checkAvailableJumpSpaces();
    }

    // gets the moves that the selected piece can jump
    function checkAvailableJumpSpaces(){
        if (turn){
            if (board[selectedPiece.indexOfBoardPiece + 14] === null 
            && cells[selectedPiece.indexOfBoardPiece + 14].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece + 7] >= 12){
                selectedPiece.fourteenthSpace = true;
            }
            if (board[selectedPiece.indexOfBoardPiece + 18] === null 
            && cells[selectedPiece.indexOfBoardPiece + 18].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece + 9] >= 12){
                selectedPiece.eighteenthSpace = true;
            }
            if (board[selectedPiece.indexOfBoardPiece - 14] === null 
            && cells[selectedPiece.indexOfBoardPiece - 14].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece - 7] >= 12){
                selectedPiece.minusFourteenthSpace = true;
            }
            if (board[selectedPiece.indexOfBoardPiece - 18] === null 
            && cells[selectedPiece.indexOfBoardPiece - 18].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece - 9] >= 12){
                selectedPiece.minusEighteenthSpace = true;
            }
        } else{
            if (board[selectedPiece.indexOfBoardPiece + 14] === null 
            && cells[selectedPiece.indexOfBoardPiece + 14].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece + 7] < 12 && board[selectedPiece.indexOfBoardPiece + 7] !== null){
                selectedPiece.fourteenthSpace = true;
            }
            if (board[selectedPiece.indexOfBoardPiece + 18] === null 
            && cells[selectedPiece.indexOfBoardPiece + 18].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece + 9] < 12 && board[selectedPiece.indexOfBoardPiece + 9] !== null){
                selectedPiece.eighteenthSpace = true;
            }
            if (board[selectedPiece.indexOfBoardPiece - 14] === null && cells[selectedPiece.indexOfBoardPiece - 14].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece - 7] < 12 
            && board[selectedPiece.indexOfBoardPiece - 7] !== null){
                selectedPiece.minusFourteenthSpace = true;
            }
            if (board[selectedPiece.indexOfBoardPiece - 18] === null && cells[selectedPiece.indexOfBoardPiece - 18].classList.contains("noPieceHere") !== true
            && board[selectedPiece.indexOfBoardPiece - 9] < 12
            && board[selectedPiece.indexOfBoardPiece - 9] !== null){
                selectedPiece.minusEighteenthSpace = true;
            }
        }
        checkPieceConditions();
    }

    // restricts movements for king
    function checkPieceConditions(){
        if (selectedPiece.isKing){
            givePieceBorder();
        } else{
            if (turn){
                selectedPiece.minusSeventhSpace = false;
                selectedPiece.minusNinthSpace = false;
                selectedPiece.minusFourteenthSpace = false;
                selectedPiece.minusEighteenthSpace = false;
            } else{
                selectedPiece.seventhSpace = false;
                selectedPiece.ninthSpace = false;
                selectedPiece.fourteenthSpace = false;
                selectedPiece.eighteenthSpace = false;
            }
            givePieceBorder();
        }
    }

    // gives green highlight for movable piece
    function givePieceBorder(){
        if (selectedPiece.seventhSpace || selectedPiece.ninthSpace || selectedPiece.fourteenthSpace || selectedPiece.eighteenthSpace
        || selectedPiece.minusSeventhSpace || selectedPiece.minusNinthSpace || selectedPiece.minusFourteenthSpace || selectedPiece.minusEighteenthSpace){
            document.getElementById(selectedPiece.pieceId).style.border = "3px solid green";
            giveCellsClick();
        } else{
            return;
        }
    }

    // gives 'click' based on possible moves
    function giveCellsClick(){
        if (selectedPiece.seventhSpace){
            cells[selectedPiece.indexOfBoardPiece + 7].setAttribute("onclick", "makeMove(7)");
        }
        if (selectedPiece.ninthSpace){
            cells[selectedPiece.indexOfBoardPiece + 9].setAttribute("onclick", "makeMove(9)");
        }
        if (selectedPiece.fourteenthSpace){
            cells[selectedPiece.indexOfBoardPiece + 14].setAttribute("onclick", "makeMove(14)");
        }
        if (selectedPiece.eighteenthSpace){
            cells[selectedPiece.indexOfBoardPiece + 18].setAttribute("onclick", "makeMove(18)");
        }
        if (selectedPiece.minusSeventhSpace){
            cells[selectedPiece.indexOfBoardPiece - 7].setAttribute("onclick", "makeMove(-7)");
        }
        if (selectedPiece.minusNinthSpace){
            cells[selectedPiece.indexOfBoardPiece - 9].setAttribute("onclick", "makeMove(-9)");
        }
        if (selectedPiece.minusFourteenthSpace){
            cells[selectedPiece.indexOfBoardPiece - 14].setAttribute("onclick", "makeMove(-14)");
        }
        if (selectedPiece.minusEighteenthSpace){
            cells[selectedPiece.indexOfBoardPiece - 18].setAttribute("onclick", "makeMove(-18)");
        }
    }

    // makes the move selected
    function makeMove(number){
        document.getElementById(selectedPiece.pieceId).remove();
        cells[selectedPiece.indexOfBoardPiece].innerHTML = "";
        if (turn){
            if (selectedPiece.isKing){
                cells[selectedPiece.indexOfBoardPiece + number].innerHTML = `<p class="redPiece king" id="${selectedPiece.pieceId}"></p>`;
                redsPieces = document.querySelectorAll("p");
            } else{
                cells[selectedPiece.indexOfBoardPiece + number].innerHTML = `<p class="redPiece" id="${selectedPiece.pieceId}"></p>`;
                redsPieces = document.querySelectorAll("p");
            }
        } else{
            if (selectedPiece.isKing){
                cells[selectedPiece.indexOfBoardPiece + number].innerHTML = `<span class="blackPiece king" id="${selectedPiece.pieceId}"></span>`;
                blacksPieces = document.querySelectorAll("span");
            } else{
                cells[selectedPiece.indexOfBoardPiece + number].innerHTML = `<span class="blackPiece" id="${selectedPiece.pieceId}"></span>`;
                blacksPieces = document.querySelectorAll("span");
            }
        }

        let indexOfPiece = selectedPiece.indexOfBoardPiece
        if (number === 14 || number === -14 || number === 18 || number === -18){
            changeData(indexOfPiece, indexOfPiece + number, indexOfPiece + number / 2);
        } else{
            changeData(indexOfPiece, indexOfPiece + number);
        }
    }

    // Changes the board states data
    function changeData(indexOfBoardPiece, modifiedIndex, removePiece){
        board[indexOfBoardPiece] = null;
        board[modifiedIndex] = parseInt(selectedPiece.pieceId);
        if (turn && selectedPiece.pieceId < 12 && modifiedIndex >= 57){
            document.getElementById(selectedPiece.pieceId).classList.add("king")
        }
        if (turn === false && selectedPiece.pieceId >= 12 && modifiedIndex <= 7){
            document.getElementById(selectedPiece.pieceId).classList.add("king");
        }
        if (removePiece){
            board[removePiece] = null;
            if (turn && selectedPiece.pieceId < 12){
                cells[removePiece].innerHTML = "";
                blackScore--
            }
            if (turn === false && selectedPiece.pieceId >= 12){
                cells[removePiece].innerHTML = "";
                redScore--
            }
        }
        resetSelectedPieceProperties();
        removeCellonclick();
        removeEventListeners();
    }

    // removes 'onClick' event listeners for player pieces
    function removeEventListeners(){
        if (turn){
            for (let i = 0; i < redsPieces.length; i++){
                redsPieces[i].removeEventListener("click", getPlayerPieces);
            }
        } else{
            for (let i = 0; i < blacksPieces.length; i++){
                blacksPieces[i].removeEventListener("click", getPlayerPieces);
            }
        }
        checkForWin();
    }

    // win-check
    function checkForWin(){
        if (blackScore === 0){
            divider.style.display = "none";
            for (let i = 0; i < RedTurn.length; i++){
                RedTurn[i].style.color = "black";
                BlackTurn[i].style.display = "none";
                RedTurn[i].textContent = "RED WINS!";
                RedTurn[i].style.opacity = "1";
            }
        } else if (redScore === 0){
            divider.style.display = "none";
            for (let i = 0; i < BlackTurn.length; i++){            
                BlackTurn[i].style.color = "black";
                RedTurn[i].style.display = "none";
                BlackTurn[i].textContent = "BLACK WINS!";
                BlackTurn[i].style.opacity = "1";
            }
        }
        changePlayer();
    }

    // changes turn
    function changePlayer(){
        if (turn && blackScore !== 0 && redScore !== 0){
            turn = false;
            for (let i = 0; i < RedTurn.length; i++){
                RedTurn[i].style.color = "lightGrey";
                RedTurn[i].style.opacity = "0.2";
                BlackTurn[i].style.color = "black";
                BlackTurn[i].style.opacity = "1";
            }
        }else if (blackScore !== 0 && redScore !== 0){
            turn = true;
            for (let i = 0; i < BlackTurn.length; i++){
                BlackTurn[i].style.color = "lightGrey";
                BlackTurn[i].style.opacity = "0.2";
                RedTurn[i].style.color = "black";
                RedTurn[i].style.opacity = "1";
            }
        }
        givePiecesEventListeners();
    }
    givePiecesEventListeners();
    </script>
</body>
</html>